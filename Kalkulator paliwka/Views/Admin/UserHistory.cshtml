@model List<KalkulatorPaliwka.Models.FuelData>

@{
    ViewData["Title"] = "Historia użytkownika";

    var users = ViewBag.Users as List<SelectListItem>;

    var selectedUser = ViewBag.SelectedUser as string;
}

<h2 class="mb-3">Historia użytkownika</h2>

<form method="post">
    <div class="form-group mb-3">
        <label for="UserId">Wybierz użytkownika:</label>
        <select name="UserId" class="form-control" required>
            <option value="">-- wybierz --</option>
            @foreach (var user in users)
            {
                <option value="@user.Value" selected="@(user.Value == selectedUser)">
                    @user.Text
                </option>
            }
        </select>
    </div>
    <button type="submit" class="btn btn-primary">Pokaż historię</button>
</form>

@if (Model != null && Model.Count > 0)

{
    <hr />
    <h4>Zużycie paliwa:</h4>
    <table class="table table-bordered">
        <thead class="table-light">
            <tr>
                <th>Pojazd ID</th>
                <th>Marka</th>
                <th>Dystans (km)</th>
                <th>Spalanie (l/100km)</th>
                <th>Cena paliwa (zł/l)</th>
                <th>Łączny koszt (zł)</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var entry in Model)

            {

                var marka = ((Dictionary<int, string>)ViewBag.VehicleBrands).ContainsKey(entry.Vehicleid)

                ? ((Dictionary<int, string>)ViewBag.VehicleBrands)[entry.Vehicleid]

                : "Nieznana";

                <tr>
                    <td>@entry.Vehicleid</td>
                    <td>@marka</td>
                    <td>@entry.Distance</td>
                    <td>@entry.FuelConsumption</td>
                    <td>@entry.FuelPrice</td>
                    <td>@entry.TotalCost</td>
                </tr>
            }
        </tbody>
    </table>

}

else if (selectedUser != null)

{
    <div class="mt-3 alert alert-info">Brak danych o zużyciu paliwa dla tego użytkownika.</div>
}
